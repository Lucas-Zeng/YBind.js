{"version":3,"sources":["YBind.js"],"names":["global","factory","module","exports","document","w","Error","window","this","noGlobal","findValueByChildren","children","returnVal","val","elm","keyword","value","undefined","split","forEach","_key","_i","hasOwnProperty","console","error","refreshViews","elms","callback","Array","prototype","call","index","ybVal","getAttribute","indexOf","replace","eventHandler","removeEventListener","addEventListener","init","obj","initObj","key","that","Object","defineProperty","get","set","domHTML","domShow","domCls","domHref","domEach","domClick","domInput","domBlur","domFocus","domChange","querySelectorAll","way","nodeName","toLowerCase","style","display","getComputedStyle","getPropertyValue","el","createElement","body","appendChild","removeChild","cssText","yb_cls","_cls","classList","remove","add","setAttribute","bind","YBind","type","exception","preventRefresh","substr","i","yb_inputBind","bind_children","parent","son","act","k","define","amd"],"mappings":"CAAE,SAAUA,EAAQC,GAEW,gBAAXC,SAAiD,gBAAnBA,QAAOC,QAE/CD,OAAOC,QAAUH,EAAOI,SAEtBH,EAASD,GAAQ,GAEjB,SAAUK,GAER,IAAMA,EAAED,SAEN,KAAM,IAAIE,OAAO,0CAInB,OAAOL,GAASI,IAMpBJ,EAASD,IAIE,mBAAXO,QAAyBA,OAASC,KAAM,SAAUD,EAAQE,GAwJhE,QAASC,GAAoBC,EAAUC,EAAWC,EAAKC,EAAKC,GAE1D,GAAIC,GAAsBC,SAAdL,EAA0BC,EAAMD,CAkB5C,OAhBAD,IAAYA,EAASO,MAAO,KAAMC,QAAS,SAAUC,EAAMC,GAEvD,IAAKL,EAAMM,eAAgBF,GAIzB,KAFAG,SAAQC,MAAO,eAAmBJ,EAAO,UAAYR,GAAaC,EAAM,cAAgBE,EAAU,QAASD,GAErG,GAAIR,OAAM,oCAIhBU,GAAQA,EAAOI,KAMdJ,EAGT,QAASS,GAAaC,EAAMX,EAASH,EAAWC,EAAKc,GAEnDC,MAAMC,UAAUV,QAAQW,KAAMJ,EAAM,SAAUZ,EAAKiB,GAEhD,GAAIC,GAAWlB,EAAImB,aAAc,MAAQlB,GACrCJ,EAAmC,IAAxBqB,EAAME,QAAS,KAAc,GAAKF,EAAMG,QAAQ,cAAe,IAC1EnB,EAAWN,EAAoBC,EAAUC,EAAWC,EAAKC,EAAKC,EAEjEY,GAAUb,EAAKiB,EAAOf,EAAOD,KAMnC,QAASqB,GAActB,EAAKiB,EAAOf,EAAOD,GAElB,kBAAVC,KAEPF,EAAIuB,oBAAqBtB,EAASD,EAAK,MAAQC,IAE/CD,EAAIwB,iBAAkBvB,EAASC,GAE/BF,EAAK,MAAQC,GAAYC,GAKhC,QAASuB,GAAMC,EAAKC,GAIlB,IAAK,GAAIC,KAAOF,GAEdhC,KAAM,KAAOkC,GAAQ,GAErB,SAAWC,EAAMH,EAAKE,EAAKzB,GAEvB2B,OAAOC,eAAgBF,EAAMD,GAE3BI,IAAK,WAEH,MAAOH,GAAM,KAAOD,IAItBK,IAAK,SAAUlC,GAEb,GAAID,GAAWoC,EAASC,EAASC,EAAQC,EAASC,EAASC,EAAUC,EAAUC,EAASC,EAAUC,CAElGd,GAAM,KAAOD,GAAQ7B,EAErBD,EAAiC,kBAAd4B,GAAKE,GAAsBF,EAAKE,GAAMZ,KAAMa,EAAM9B,EAAK6B,EAAK,KAAOA,GAAQzB,EAE9F+B,EAAY5C,SAASsD,iBAAkB,aAAehB,EAAM,kBAAoBA,EAAM,OAEtFO,EAAY7C,SAASsD,iBAAkB,aAAehB,EAAM,kBAAoBA,EAAM,OAEtFQ,EAAY9C,SAASsD,iBAAkB,cAAgBhB,EAAM,mBAAqBA,EAAM,OAExFS,EAAY/C,SAASsD,iBAAkB,aAAehB,EAAM,kBAAoBA,EAAM,OAEtFU,EAAYhD,SAASsD,iBAAkB,aAAehB,EAAM,kBAAoBA,EAAM,OAEtFW,EAAYjD,SAASsD,iBAAkB,cAAgBhB,EAAM,mBAAqBA,EAAM,OAExFY,EAAYlD,SAASsD,iBAAkB,cAAgBhB,EAAM,mBAAqBA,EAAM,OAExFa,EAAYnD,SAASsD,iBAAkB,aAAehB,EAAM,kBAAoBA,EAAM,OAEtFc,EAAYpD,SAASsD,iBAAkB,cAAgBhB,EAAM,mBAAqBA,EAAM,OAExFe,EAAYrD,SAASsD,iBAAkB,eAAiBhB,EAAM,oBAAsBA,EAAM,OAE1FjB,EAAcuB,EAAS,OAAQpC,EAAWC,EAAK,SAAUC,EAAKiB,EAAOf,GAElE,GAAI2C,GAAoC,SAA9B7C,EAAI8C,SAASC,eAA0D,YAA9B/C,EAAI8C,SAASC,cAA8B,QAAU,WAExG/C,GAAK6C,GAAQ3C,IAIhBS,EAAcwB,EAAS,OAAQrC,EAAWC,EAAK,SAAUC,EAAKiB,EAAOf,GAEnE,GAAKA,GAQD,GAFqB,QAArBF,EAAIgD,MAAMC,UAAuBjD,EAAIgD,MAAMC,QAAU,IAEY,QAA7DC,iBAAkBlD,EAAK,IAAKmD,iBAAkB,WAAuB,CAEvE,GAAIF,GAAU,GACNG,EAAM9D,SAAS+D,cAAerD,EAAI8C,SAASC,cAEnDzD,UAASgE,KAAKC,YAAaH,GAE3BH,EAAUC,iBAAkBE,EAAI,IAAKD,iBAAkB,WAEvD7D,SAASgE,KAAKE,YAAaJ,GAE3BpD,EAAIgD,MAAMC,QAAqB,QAAXA,EAAoB,QAAUA,OAjBpDjD,GAAIgD,MAAMS,SAAW,kBAyB3B9C,EAAcyB,EAAQ,QAAStC,EAAWC,EAAK,SAAUC,EAAKiB,EAAOf,GAEnEA,GAAS,GAETF,EAAI0D,QAAU1D,EAAI0D,OAAOtD,MAAM,KAAKC,QAAS,SAAUsD,EAAMpD,GAEzDoD,GAAQ3D,EAAI4D,UAAUC,OAAQF,KAIjCzD,GAASA,EAAME,MAAM,KAAKC,QAAS,SAAUsD,EAAMpD,GAEhDoD,GAAQ3D,EAAI4D,UAAUE,IAAKH,KAI9B3D,EAAI0D,OAASxD,IAIhBS,EAAc0B,EAAS,OAAQvC,EAAWC,EAAK,SAAUC,EAAKiB,EAAOf,GAEnEF,EAAI+D,aAAc,OAAS7D,KAI7BS,EAAc2B,EAAS,OAAQxC,EAAWC,EAAK,SAAUC,EAAKiB,EAAOf,GAElD,kBAAVA,IAAwBA,EAAMc,KAAMhB,EAAKiB,KAIlDN,EAAc4B,EAAU,QAASzC,EAAWC,EAAKuB,GAEjDX,EAAc6B,EAAU,QAAS1C,EAAWC,EAAKuB,GAEjDX,EAAc8B,EAAS,OAAQ3C,EAAWC,EAAKuB,GAE/CX,EAAc+B,EAAU,QAAS5C,EAAWC,EAAKuB,GAEjDX,EAAcgC,EAAW,SAAU7C,EAAWC,EAAKuB,OAMvD5B,KAAMgC,EAAKE,EAGjB,KAAK,GAAIA,KAAOD,GAEdC,IAAOF,KAAShC,KAAM,KAAOkC,GAAQD,EAASC,GAIhDlC,MAAKsE,OAlVP,GAAIC,GAAQ,SAAUvC,EAAKC,GAEzB,GAAkB,gBAAPD,GAAkB,KAAM,IAAIlC,OAAO,+BAE9C,OAAME,gBAAgBuE,IAEtBxC,EAAKT,KAAMtB,KAAMgC,EAAKC,GAEtBjC,KAAKwE,KAAO,QAELxE,MAN+B,GAAIuE,GAAOvC,EAAMC,GA+IzD,OArIAsC,GAAMlD,WAEJkB,IAAK,SAAUP,EAAKyC,EAAWC,GAE7B,GAAmB,gBAAR1C,GAAmB,KAAM,IAAIlC,OAAO,+BAE/C2E,GAAYA,KAEZ,KAAK,GAAIvC,KAAOF,GAAK,CAEnB,GAAIpB,GAAOoB,EAAIwC,OAASxE,KAAKwE,KAAOtC,EAAIyC,OAAO,GAAKzC,CAExB,QAAtBuC,EAAW7D,IAEfsB,IAAOlC,SAAWkC,IAAOqC,GAAMlD,aAAiBrB,KAAM0E,EAAiB,KAAO9D,EAAOA,GAA+BH,SAAtBgE,EAAW7D,GAAuB6D,EAAW7D,GAASoB,EAAKE,IAI7J,MAAOlC,OAITsE,KAAM,WAEJ,GAAiBpC,GAAbC,EAAOnC,IAEX,KAAKkC,IAAOlC,OAEV,SAAYkC,GAEiB,GAAvBA,EAAIR,QAAS,OAEfN,MAAMC,UAAUV,QAAQW,KAAM1B,SAASsD,iBAAkB,aAAehB,EAAIyC,OAAO,GAAK,MAAQ,SAAUrE,EAAKsE,IAE3E,SAA9BtE,EAAI8C,SAASC,eAA0D,YAA9B/C,EAAI8C,SAASC,iBAExD/C,EAAIuB,oBAAqB,SAAUvB,EAAIuE,cAEvCvE,EAAIuE,aAAe,WAEjB,GAAKrD,GAAQlB,EAAImB,aAAc,WAC1BqD,EAAwC,IAAxBtD,EAAME,QAAS,KAAc,GAAKF,EAAMG,QAAS,cAAgB,IACjFoD,EAAS5C,EACT9B,EAAM8B,EAAMD,GACZ8C,EAAM,EAEVF,IAAiBA,EAAcpE,MAAO,KAAMC,QAAS,SAAUC,EAAMgE,GAElE,IAAKvE,EAAIS,eAAgBF,GAIvB,KAFAG,SAAQC,MAAO,eAAmBJ,EAAO,UAAYuB,EAAMD,IAASC,EAAM,uBAAwB7B,GAE5F,GAAIR,OAAO,oCAIfiF,GAAS1E,EACTA,EAASA,EAAKO,GACdoE,EAASpE,IAMhBmE,EAAe,IAAPC,EAAY9C,EAAM8C,GAAQhF,KAAKQ,MAEvC2B,EAAK8C,IAAK/C,EAAIyC,OAAO,KAIxBrE,EAAIwB,iBAAkB,SAAWxB,EAAIuE,kBAQzC3C,EAIN,OAAOlC,OAITiF,IAAK,SAAU/C,GAEb,GAAIA,EAEFA,IAAOlC,QAAUA,KAAMkC,GAAQlC,KAAMkC,QAIrC,KAAK,GAAIgD,KAAKlF,MAEQ,gBAAbA,MAAMkF,KAAqBlF,KAAMkF,EAAEP,OAAO,IAAO3E,KAAMkF,EAAEP,OAAO,IAM3E,OAAO3E,OAGToE,IAAK,SAAUpC,EAAKC,GAIlB,MAFAF,GAAKT,KAAMtB,KAAMgC,EAAKC,GAEfjC,OAMXuE,EAAMD,MAASA,MAAM,GAEE,kBAAXa,SAAyBA,OAAOC,KAE1CD,UAAW,WAET,MAAOZ,KAMPtE,IAEAF,EAAOwE,MAASA,GAIbA","file":"YBind.min.js","sourcesContent":["( function( global, factory ) {\r\n\r\n        if ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\r\n\r\n          module.exports = global.document ?\r\n\r\n            factory( global, true ) :\r\n\r\n            function( w ) {\r\n\r\n              if ( !w.document ) {\r\n\r\n                throw new Error( \"YBind requires a window with a document\" );\r\n\r\n              }\r\n\r\n              return factory( w );\r\n\r\n            };\r\n\r\n        } else {\r\n\r\n          factory( global );\r\n\r\n        }\r\n\r\n}( typeof window !== \"undefined\" ? window : this, function( window, noGlobal ) {\r\n\r\n    var YBind = function( obj, initObj ) {\r\n\r\n      if( typeof obj !=='object' ) throw new Error( 'Only object arg is accepted!' );\r\n\r\n      if( !(this instanceof YBind) ) return new YBind( obj , initObj );\r\n\r\n      init.call( this, obj, initObj );\r\n      \r\n      this.type = 'YBind';\r\n\r\n      return this;\r\n\r\n    }\r\n\r\n    YBind.prototype = {\r\n\r\n      set: function( obj, exception, preventRefresh ) {\r\n\r\n        if( typeof obj !== 'object' ) throw new Error( 'Only object arg is accepted!' );\r\n\r\n        exception = exception || {};\r\n\r\n        for( var key in obj ){\r\n\r\n          var _key = obj.type === this.type ? key.substr(2) : key;\r\n\r\n            if( exception[ _key ] === null ) continue;\r\n\r\n            key in this && !( key in YBind.prototype ) && ( this[ preventRefresh ? '__' + _key : _key ] = exception[ _key ] !== undefined ? exception[ _key ] : obj[ key ] );\r\n\r\n        }\r\n\r\n        return this;\r\n\r\n      },\r\n\r\n      bind: function() {\r\n\r\n        var that = this, key;\r\n\r\n        for( key in this ){\r\n\r\n          ( function( key ) {\r\n\r\n            if( key.indexOf( '__' ) == 0 ){\r\n\r\n              Array.prototype.forEach.call( document.querySelectorAll( '[yb-bind=\"' + key.substr(2) + '\"]' ), function( elm, i ) {\r\n\r\n                if( elm.nodeName.toLowerCase() == 'input' || elm.nodeName.toLowerCase() == 'textarea' ){\r\n\r\n                  elm.removeEventListener( 'change', elm.yb_inputBind );\r\n\r\n                  elm.yb_inputBind = function(){\r\n\r\n                    var  ybVal = elm.getAttribute( 'yb-bind' ),\r\n                         bind_children = ybVal.indexOf( '.' ) == -1 ? '' : ybVal.replace( /^(\\w|\\-)*\\./ , ''), \r\n                         parent = that,\r\n                         val = that[ key ],\r\n                         son = '';\r\n\r\n                     bind_children && bind_children.split( '.' ).forEach( function( _key, i ) {\r\n\r\n                        if( !val.hasOwnProperty( _key ) ){\r\n\r\n                          console.error( 'Can\\'t find \\'' + _key + '\\' under', that[ key ] || that, '. Check yb-bind in: ', elm);\r\n\r\n                          throw new Error( 'Please check above error message.' );\r\n\r\n                        }else{\r\n\r\n                            parent = val;\r\n                            val    = val[ _key ],\r\n                            son    = _key;\r\n\r\n                        }\r\n\r\n                     });\r\n\r\n                     parent[ son == '' ? key : son ] = this.value;\r\n\r\n                     that.act( key.substr(2) );\r\n\r\n                  }\r\n\r\n                  elm.addEventListener( 'change' , elm.yb_inputBind );\r\n\r\n                }\r\n\r\n              });\r\n\r\n            }\r\n\r\n          })( key )\r\n\r\n        }\r\n\r\n        return this;\r\n\r\n      },\r\n\r\n      act: function( key ) {\r\n\r\n        if( key ){\r\n\r\n          key in this && ( this[ key ] = this[ key ] );\r\n\r\n        } else {\r\n\r\n          for( var k in this ) {\r\n\r\n            typeof this[ k ] == 'object' && ( this[ k.substr(2) ] = this[ k.substr(2) ] )\r\n\r\n          }\r\n\r\n        }\r\n\r\n        return this;\r\n      },\r\n\r\n      add: function( obj, initObj ){\r\n        \r\n        init.call( this, obj, initObj );\r\n\r\n        return this;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    YBind.bind = { bind: true }\r\n\r\n    if ( typeof define === \"function\" && define.amd ) {\r\n\r\n      define([], function() {\r\n\r\n        return YBind;\r\n\r\n      });\r\n\r\n    }\r\n\r\n    if(!noGlobal){\r\n\r\n        window.YBind =  YBind;\r\n\r\n    }\r\n\r\n    return YBind;\r\n\r\n    //private\r\n    function findValueByChildren(children, returnVal, val, elm, keyword){\r\n\r\n      var value = returnVal === undefined ? val : returnVal;\r\n\r\n      children && children.split( '.' ).forEach( function( _key, _i ) {\r\n\r\n          if( !value.hasOwnProperty( _key ) ){\r\n\r\n            console.error( 'Can\\'t find \\'' + _key + '\\' under', returnVal || val , '. Check yb-' + keyword + ' in: ', elm);\r\n\r\n            throw new Error('Please check above error message.');\r\n\r\n          } else {\r\n\r\n            value = value[ _key ];\r\n\r\n          }\r\n\r\n      });\r\n\r\n      return value;\r\n    }\r\n\r\n    function refreshViews(elms, keyword, returnVal, val, callback){\r\n\r\n      Array.prototype.forEach.call( elms, function( elm, index ) {\r\n\r\n         var ybVal    = elm.getAttribute( 'yb-' + keyword ),\r\n             children = ybVal.indexOf( '.' ) == -1 ? '' : ybVal.replace(/^(\\w|\\-)*\\./, ''),\r\n             value    = findValueByChildren(children, returnVal, val, elm, keyword);\r\n\r\n          callback( elm, index, value, keyword );\r\n\r\n      });\r\n\r\n    }\r\n\r\n    function eventHandler( elm, index, value, keyword ){\r\n\r\n       if( typeof value === 'function' ){\r\n\r\n           elm.removeEventListener( keyword, elm[ 'yb_' + keyword ] );\r\n\r\n           elm.addEventListener( keyword, value );\r\n\r\n           elm[ 'yb_' + keyword ] = value;\r\n\r\n        }\r\n    }\r\n\r\n    function init( obj, initObj ){\r\n\r\n      var that = this;\r\n\r\n      for( var key in obj ){\r\n\r\n        this[ '__' + key ] = '';\r\n\r\n        (function( that, obj, key, undefined ) {\r\n\r\n            Object.defineProperty( that, key, {\r\n              \r\n              get: function() {\r\n\r\n                return that[ '__' + key ];\r\n\r\n              },  \r\n\r\n              set: function( val ) {\r\n                \r\n                var returnVal, domHTML, domShow, domCls, domHref, domEach, domClick, domInput, domBlur, domFocus, domChange;\r\n\r\n                that[ '__' + key ] = val;\r\n\r\n                returnVal = typeof obj[ key ] == 'function' ? obj[ key ].call( that, val, key, '__' + key ) : undefined;  \r\n\r\n                domHTML   = document.querySelectorAll( '[yb-bind=\"' + key + '\"], [yb-bind^=\"' + key + '.\"]' );\r\n\r\n                domShow   = document.querySelectorAll( '[yb-show=\"' + key + '\"], [yb-show^=\"' + key + '.\"]' );\r\n\r\n                domCls    = document.querySelectorAll( '[yb-class=\"' + key + '\"], [yb-class^=\"' + key + '.\"]' );\r\n\r\n                domHref   = document.querySelectorAll( '[yb-href=\"' + key + '\"], [yb-href^=\"' + key + '.\"]' );\r\n\r\n                domEach   = document.querySelectorAll( '[yb-each=\"' + key + '\"], [yb-each^=\"' + key + '.\"]' );\r\n\r\n                domClick  = document.querySelectorAll( '[yb-click=\"' + key + '\"], [yb-click^=\"' + key + '.\"]' );\r\n\r\n                domInput  = document.querySelectorAll( '[yb-input=\"' + key + '\"], [yb-input^=\"' + key + '.\"]' );\r\n\r\n                domBlur   = document.querySelectorAll( '[yb-blur=\"' + key + '\"], [yb-blur^=\"' + key + '.\"]' );\r\n\r\n                domFocus  = document.querySelectorAll( '[yb-focus=\"' + key + '\"], [yb-focus^=\"' + key + '.\"]' );\r\n\r\n                domChange = document.querySelectorAll( '[yb-change=\"' + key + '\"], [yb-change^=\"' + key + '.\"]' );\r\n\r\n                refreshViews( domHTML, 'bind', returnVal, val, function( elm, index, value ) {\r\n\r\n                   var way = elm.nodeName.toLowerCase() == 'input' || elm.nodeName.toLowerCase() == 'textarea' ? 'value' : 'innerHTML';\r\n\r\n                   elm[ way ] = value;\r\n\r\n                });\r\n\r\n                refreshViews( domShow, 'show', returnVal, val, function( elm, index, value ) {\r\n\r\n                  if( !value ){\r\n\r\n                      elm.style.cssText += 'display:none;';\r\n\r\n                  } else {\r\n\r\n                      elm.style.display == 'none' && ( elm.style.display = '' );\r\n\r\n                      if( getComputedStyle( elm, '' ).getPropertyValue( 'display' ) == 'none') {\r\n\r\n                        var display = '', \r\n                                el =  document.createElement( elm.nodeName.toLowerCase() );\r\n\r\n                        document.body.appendChild( el );\r\n\r\n                        display = getComputedStyle( el, '' ).getPropertyValue( 'display' );\r\n\r\n                        document.body.removeChild( el );\r\n\r\n                        elm.style.display = display == 'none' ? 'block' : display;   \r\n\r\n                       }\r\n\r\n                    }\r\n\r\n                });\r\n\r\n                refreshViews( domCls, 'class', returnVal, val, function( elm, index, value ) {\r\n\r\n                  value += '';\r\n                  \r\n                  elm.yb_cls && elm.yb_cls.split(' ').forEach( function( _cls, _i ) {\r\n\r\n                      _cls && elm.classList.remove( _cls );\r\n\r\n                   });\r\n\r\n                   value && value.split(' ').forEach( function( _cls, _i ) {\r\n\r\n                      _cls && elm.classList.add( _cls ); \r\n\r\n                   });\r\n\r\n                   elm.yb_cls = value;\r\n\r\n                });\r\n\r\n                refreshViews( domHref, 'href', returnVal, val, function( elm, index, value ) {\r\n\r\n                  elm.setAttribute( 'href' , value);\r\n\r\n                });\r\n\r\n                refreshViews( domEach, 'each', returnVal, val, function( elm, index, value ) {\r\n\r\n                  typeof value === 'function' && value.call( elm, index );\r\n\r\n                });\r\n\r\n                refreshViews( domClick, 'click', returnVal, val, eventHandler);\r\n\r\n                refreshViews( domInput, 'input', returnVal, val, eventHandler);\r\n\r\n                refreshViews( domBlur, 'blur', returnVal, val, eventHandler);\r\n\r\n                refreshViews( domFocus, 'focus', returnVal, val, eventHandler);\r\n\r\n                refreshViews( domChange, 'change', returnVal, val, eventHandler);\r\n\r\n              }\r\n\r\n            });\r\n\r\n        })( this, obj, key )\r\n      }\r\n\r\n      for( var key in initObj ){\r\n\r\n        key in obj && ( this[ '__' + key ] = initObj[ key ] );\r\n\r\n      }\r\n\r\n      this.bind();\r\n    }\r\n    \r\n}));\r\n\r\n\r\n"],"sourceRoot":"/source/"}